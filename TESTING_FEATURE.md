# è‡ªåŠ¨åŒ–æµ‹è¯•åŠŸèƒ½è¯´æ˜

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

å·²å°†è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆåˆ°è®¾ç½®é¡µï¼Œæä¾›å®Œæ•´çš„æµ‹è¯•ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š
- æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Šåˆ—è¡¨å’Œè¯¦æƒ…
- å‘èµ·æ–°çš„æµ‹è¯•ï¼ˆå¯é€‰æ‹©æµ‹è¯•èŒƒå›´ï¼‰
- å®æ—¶æŸ¥çœ‹æµ‹è¯•è¿›åº¦å’Œç»“æœ

## ğŸ—‚ï¸ æ•°æ®æ¨¡å‹

### æµ‹è¯•æŠ¥å‘Šå­—æ®µå®šä¹‰

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `id` | string | æµ‹è¯•æŠ¥å‘Š IDï¼ˆUUIDï¼‰ |
| `test_scopes` | string[] | æµ‹è¯•åŠŸèƒ½èŒƒå›´ï¼ˆå¦‚ï¼šunit, integration, service, api, e2eï¼‰ |
| `test_count` | number | æµ‹è¯•æ€»æ•° |
| `passed_count` | number | é€šè¿‡çš„æµ‹è¯•æ•° |
| `failed_count` | number | å¤±è´¥çš„æµ‹è¯•æ•° |
| `error_count` | number | é”™è¯¯çš„æµ‹è¯•æ•° |
| `skipped_count` | number | è·³è¿‡çš„æµ‹è¯•æ•° |
| `progress` | number | æµ‹è¯•è¿›åº¦ï¼ˆ0-100ï¼‰ |
| `status` | string | æµ‹è¯•çŠ¶æ€ï¼šrunningï¼ˆè¿è¡Œä¸­ï¼‰ã€passedï¼ˆé€šè¿‡ï¼‰ã€failedï¼ˆå¤±è´¥ï¼‰ã€errorï¼ˆé”™è¯¯ï¼‰ |
| `result` | object | æµ‹è¯•ç»“æœè¯¦æƒ…ï¼ˆåŒ…å« stdout, stderr ç­‰ï¼‰ |
| `started_at` | datetime | å¼€å§‹æ—¶é—´ |
| `completed_at` | datetime | å®Œæˆæ—¶é—´ |
| `duration` | number | è€—æ—¶ï¼ˆç§’ï¼‰ |
| `created_at` | datetime | åˆ›å»ºæ—¶é—´ |

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### 1. æµ‹è¯•æŠ¥å‘Šåˆ—è¡¨

- âœ… æ˜¾ç¤ºæ‰€æœ‰æµ‹è¯•æŠ¥å‘Šè®°å½•
- âœ… æ”¯æŒåˆ†é¡µå’Œç­›é€‰
- âœ… æ˜¾ç¤ºæµ‹è¯•çŠ¶æ€ã€è¿›åº¦ã€ç»Ÿè®¡ä¿¡æ¯
- âœ… å®æ—¶åˆ·æ–°è¿è¡Œä¸­çš„æµ‹è¯•

### 2. å‘èµ·æ–°æµ‹è¯•

- âœ… å¯é€‰æ‹©æµ‹è¯•åŠŸèƒ½èŒƒå›´ï¼š
  - å•å…ƒæµ‹è¯• (unit)
  - é›†æˆæµ‹è¯• (integration)
  - æœåŠ¡å±‚æµ‹è¯• (service)
  - API æµ‹è¯• (api)
  - ç«¯åˆ°ç«¯æµ‹è¯• (e2e)
- âœ… æ”¯æŒå¤šé€‰
- âœ… åå°å¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡ç•Œé¢

### 3. æµ‹è¯•æŠ¥å‘Šè¯¦æƒ…

- âœ… æŸ¥çœ‹å®Œæ•´çš„æµ‹è¯•æŠ¥å‘Šä¿¡æ¯
- âœ… æ˜¾ç¤ºæµ‹è¯•è¾“å‡ºï¼ˆstdoutï¼‰
- âœ… æ˜¾ç¤ºæµ‹è¯•ç»Ÿè®¡
- âœ… æ˜¾ç¤ºæµ‹è¯•æ—¶é—´çº¿

### 4. æµ‹è¯•ç»Ÿè®¡

- âœ… æ€»æŠ¥å‘Šæ•°
- âœ… é€šè¿‡æ•°é‡
- âœ… å¤±è´¥æ•°é‡
- âœ… è¿è¡Œä¸­æ•°é‡

## ğŸ“ æ–‡ä»¶ç»“æ„

### åç«¯

- **`app/services/test_runner.py`** - æµ‹è¯•è¿è¡ŒæœåŠ¡
  - `TestRunner` ç±»ï¼šç®¡ç†æµ‹è¯•æ‰§è¡Œå’ŒæŠ¥å‘Šå­˜å‚¨
  - æ•°æ®åº“è¡¨ï¼š`test_reports`, `test_report_details`
  
- **`app/routes/testing.py`** - æµ‹è¯•ç®¡ç† API è·¯ç”±
  - `POST /api/testing/run` - è¿è¡Œæµ‹è¯•
  - `GET /api/testing/reports` - è·å–æŠ¥å‘Šåˆ—è¡¨
  - `GET /api/testing/reports/{report_id}` - è·å–æŠ¥å‘Šè¯¦æƒ…
  - `DELETE /api/testing/reports/{report_id}` - åˆ é™¤æŠ¥å‘Š
  - `GET /api/testing/stats` - è·å–ç»Ÿè®¡ä¿¡æ¯

### å‰ç«¯

- **`frontend/src/components/TestingPage.tsx`** - æµ‹è¯•ç®¡ç†é¡µé¢
  - æµ‹è¯•æŠ¥å‘Šåˆ—è¡¨å±•ç¤º
  - è¿è¡Œæµ‹è¯•å¯¹è¯æ¡†
  - æŠ¥å‘Šè¯¦æƒ…å¯¹è¯æ¡†
  
- **`frontend/src/components/TestingPage.css`** - æ ·å¼æ–‡ä»¶

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. è®¿é—®æµ‹è¯•ç®¡ç†é¡µé¢

ä»è®¾ç½®èœå•ï¼ˆå³ä¸Šè§’ï¼‰â†’ **è‡ªåŠ¨åŒ–æµ‹è¯•**

### 2. è¿è¡Œæµ‹è¯•

1. ç‚¹å‡» **"è¿è¡Œæµ‹è¯•"** æŒ‰é’®
2. é€‰æ‹©è¦æµ‹è¯•çš„åŠŸèƒ½èŒƒå›´ï¼ˆå¯å¤šé€‰ï¼‰
3. ç‚¹å‡» **"å¼€å§‹è¿è¡Œ"**
4. æµ‹è¯•å°†åœ¨åå°æ‰§è¡Œ

### 3. æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š

- åœ¨åˆ—è¡¨ä¸­æŸ¥çœ‹æ‰€æœ‰æµ‹è¯•æŠ¥å‘Š
- ç‚¹å‡» **"æŸ¥çœ‹"** æŒ‰é’®æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š
- è¿è¡Œä¸­çš„æµ‹è¯•ä¼šè‡ªåŠ¨åˆ·æ–°è¿›åº¦

### 4. æŸ¥çœ‹æµ‹è¯•è¯¦æƒ…

æŠ¥å‘Šè¯¦æƒ…åŒ…æ‹¬ï¼š
- æµ‹è¯•æŠ¥å‘Š ID
- æµ‹è¯•åŠŸèƒ½èŒƒå›´
- æµ‹è¯•ç»Ÿè®¡ï¼ˆæ€»æ•°ã€é€šè¿‡ã€å¤±è´¥ç­‰ï¼‰
- æµ‹è¯•è¿›åº¦
- å¼€å§‹/å®Œæˆæ—¶é—´
- æµ‹è¯•è¾“å‡ºï¼ˆstdoutï¼‰

## ğŸ”§ API ç«¯ç‚¹

### è¿è¡Œæµ‹è¯•

```http
POST /api/testing/run
Content-Type: application/json

{
  "test_scopes": ["unit", "integration", "service"]
}
```

å“åº”ï¼š
```json
{
  "success": true,
  "report_id": "uuid-string",
  "message": "æµ‹è¯•å·²å¼€å§‹è¿è¡Œ"
}
```

### è·å–æŠ¥å‘Šåˆ—è¡¨

```http
GET /api/testing/reports?limit=50&offset=0&status=passed
```

### è·å–æŠ¥å‘Šè¯¦æƒ…

```http
GET /api/testing/reports/{report_id}
```

### åˆ é™¤æŠ¥å‘Š

```http
DELETE /api/testing/reports/{report_id}
```

### è·å–ç»Ÿè®¡ä¿¡æ¯

```http
GET /api/testing/stats
```

å“åº”ï¼š
```json
{
  "total": 10,
  "passed": 8,
  "failed": 1,
  "running": 1,
  "error": 0
}
```

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### test_reports è¡¨

```sql
CREATE TABLE test_reports (
    id TEXT PRIMARY KEY,
    test_scopes TEXT NOT NULL,  -- JSON æ•°ç»„
    test_count INTEGER DEFAULT 0,
    passed_count INTEGER DEFAULT 0,
    failed_count INTEGER DEFAULT 0,
    error_count INTEGER DEFAULT 0,
    skipped_count INTEGER DEFAULT 0,
    progress REAL DEFAULT 0.0,
    status TEXT DEFAULT 'running',
    result TEXT,  -- JSON å¯¹è±¡
    started_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    completed_at DATETIME,
    duration REAL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## âš™ï¸ é…ç½®è¯´æ˜

æµ‹è¯•è¿è¡Œå™¨ä½¿ç”¨ç»Ÿä¸€çš„ç³»ç»Ÿæ•°æ®åº“ï¼ˆ`SYSTEM_DB_PATH`ï¼‰ï¼Œä¸é¡¹ç›®çš„å…¶ä»–ç³»ç»Ÿæ•°æ®å­˜å‚¨åœ¨åŒä¸€æ•°æ®åº“ä¸­ã€‚

## ğŸ¨ UI ç‰¹æ€§

- **å®æ—¶è¿›åº¦æ›´æ–°**ï¼šè¿è¡Œä¸­çš„æµ‹è¯•æ¯ 3 ç§’è‡ªåŠ¨åˆ·æ–°
- **çŠ¶æ€æ ‡ç­¾**ï¼šä¸åŒé¢œè‰²å’Œå›¾æ ‡æ ‡è¯†æµ‹è¯•çŠ¶æ€
- **ç»Ÿè®¡å¡ç‰‡**ï¼šä¸€ç›®äº†ç„¶çš„æµ‹è¯•ç»Ÿè®¡ä¿¡æ¯
- **å“åº”å¼è®¾è®¡**ï¼šé€‚é…ä¸åŒå±å¹•å°ºå¯¸

## ğŸ”„ åç»­ä¼˜åŒ–å»ºè®®

1. **å®æ—¶æ—¥å¿—æµ**ï¼šä½¿ç”¨ WebSocket æˆ– SSE å®æ—¶æ¨é€æµ‹è¯•æ—¥å¿—
2. **æµ‹è¯•è¯¦æƒ…ç»†åŒ–**ï¼šä¿å­˜æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹çš„è¯¦ç»†ç»“æœ
3. **æµ‹è¯•å†å²å¯¹æ¯”**ï¼šå¯¹æ¯”ä¸åŒç‰ˆæœ¬çš„æµ‹è¯•ç»“æœ
4. **æµ‹è¯•è¶‹åŠ¿å›¾è¡¨**ï¼šå¯è§†åŒ–æµ‹è¯•é€šè¿‡ç‡è¶‹åŠ¿
5. **æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š**ï¼šé›†æˆä»£ç è¦†ç›–ç‡æ•°æ®

## ğŸ“ æ³¨æ„äº‹é¡¹

1. æµ‹è¯•è¿è¡Œåœ¨åå°å¼‚æ­¥æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡å…¶ä»–æ“ä½œ
2. é•¿æ—¶é—´è¿è¡Œçš„æµ‹è¯•ä¼šæœ‰ 5 åˆ†é’Ÿè¶…æ—¶é™åˆ¶
3. æµ‹è¯•ä½¿ç”¨é¡¹ç›®é…ç½®çš„è™šæ‹Ÿç¯å¢ƒæ‰§è¡Œ
4. ç¡®ä¿ `pytest` å’Œç›¸å…³ä¾èµ–å·²æ­£ç¡®å®‰è£…









